<!doctype html>
<html>
<head>
<script src="./babel-browser.min.js"></script>
<script src="../node_modules/es6-module-loader/dist/es6-module-loader-dev.js"></script>
<script src="../bower_components/jxon/index.js"></script>
<script>
System.transpiler = 'babel';
</script>
</head>
<body>
<script>
'use strict';
System.import(
  '../Frontiers.js'
).then(function(Frontiers){
  Frontiers = Frontiers.default;
  window.Frontiers = Frontiers;
  console.log('FRONTIERS.JS is loaded!');
  function setDisabled(isDisabled){
    var
      disabledStuffs = this.querySelectorAll('*[disabled]'),
      i = 0|0
    ;
    for(i=0;i<disabledStuffs.length;++i){
      disabledStuffs[i].disabled = isDisabled;
    }
  }
  var
    form = document.querySelector('form'),
    directory = form.querySelector('[type="url"]'),
    path = location.pathname.split('/')
  ;
  path.pop();
  path.pop();
  path.push('Data');
  path.unshift(location.hostname);
  directory.value = location.protocol + '//' + path.join('/');
  setDisabled.call(form, false);
  form.addEventListener('submit', function(e){
    e.preventDefault();
    setDisabled.call(this, true);
    Frontiers.Data.GameData.IO.InitializeSystemPaths(
      directory.value
    ).catch(function(e){
      alert('Error!');
      console.error(e);
    }).then(function(e){
      Frontiers.Data.GameData.IO.LoadTerrainHeights(
        513,
        'C-0-0-100',
        'Raw16Mac',
        Frontiers.DataType.World
      ).then(function(heights){
        console.log(heights); // an array of Float32Array instances
      });
      Frontiers.Data.GameData.IO.LoadTerrainCanvas(
        513,
        'C-0-0-100',
        'Raw16Mac',
        Frontiers.DataType.World
      ).then(function(canvas){
        document.body.appendChild(canvas);
      });
    });
  });
}, function(failure){
  console.error(failure);
});
</script>
<form>
<input
  type="url"
  placeholder="path to folder for a Chunk"
  disabled
>
<button type="submit" disabled>Get</button>
</form>
</body>
</html>
